<!doctype html>
<html lang="en" prefix="og: http://ogp.me/ns#">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>WikiSearch</title>
    <meta name="description" content="WikiSearch - a general purpose search engine">

    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link
        href="https://fonts.googleapis.com/css?family=Pacifico:100,100i,300,300i,400,400i,700,700i%Roboto:100,100i,300,300i,400,400i,700,700i%7CMaitree:200,300,400,600,700&amp;subset=latin-ext"
        rel="stylesheet">

    <link rel="stylesheet" type='text/css' media='all' href="./static/css/webslides.css">
    <link rel="stylesheet" type="text/css" media="all" href="./static/css/svg-icons.css">
    <style>
        .content-left p {
            line-height: 2.25rem;
            font-size: 18pt;
        }

        .content-left h2 {
            line-height: 3.25rem;
        }

        h1.text-landing {
            font-family: Pacifico;
            letter-spacing: 0.75rem;
            text-transform: none;
        }

        h2 {
            font-size: 36pt;
        }

        h2.text-landing {
            letter-spacing: 0.5rem;
        }

        h3 {
            font-size: 25pt;
            font-weight: 400;
        }

        h4 {
            font-size: 22pt;
            font-weight: 400;
        }

        ul,
        ol,
        ul li,
        ol li,
        p {
            font-size: 18pt;
            line-height: 2.25rem;
            color: #595959;
        }

        section.wrap {
            padding: 0;
        }

        h3+hr {
            margin: 0.5rem auto;
            margin-bottom: 1.5rem;
        }
    </style>
</head>

<body>
    <!-- <header role="banner">
      <nav role="navigation">
        <p class="logo"><a href="../index.html" title="WebSlides">WebSlides</a></p>
        <ul>
          <li class="github">
            <a rel="external" href="https://github.com/webslides/webslides" title="Github">
              <svg class="fa-github">
                <use xlink:href="#fa-github"></use>
              </svg>
              <em>WebSlides</em>
            </a>
          </li>
          <li class="twitter">
            <a rel="external" href="https://twitter.com/webslides" title="Twitter">
              <svg class="fa-twitter">
                <use xlink:href="#fa-twitter"></use>
              </svg>
              <em>@WebSlides</em>
            </a>
          </li>
        </ul>
      </nav>
    </header> -->

    <main role="main">
        <article id="webslides" class="vertical">
            <section class="wrap">
                <span class="bg-trans-light" style="background-image:url('./static/images/code.png')"></span>
                <div class="wrap aligncenter">
                    <h1 class="text-landing">WikiSearch</h1>
                    <p class="text-intro">Търсачка с общо предназначение</p>
                </div>
            </section>
            <section class="wrap">
                <div class="wrap size-75">
                    <h3>Съдържание</h3>
                    <hr>
                    <div class="size-75">
                        <div class="bg-white shadow">
                            <ol>
                                <li><a target="_blank" href="#slide=4">Задача</a></li>
                                <li><a target="_blank" href="#slide=6">Имплементация</a></li>
                                <li><a target="_blank" href="#slide=15">Резултати</a>
                                    <ul>
                                        <li><a target="_blank" href="#slide=16">Live Demo</a></li>
                                        <li><a target="_blank" href="#slide=17">Метрики</a></li>
                                    </ul>
                                </li>
                                <li><a target="_blank" href="#slide=22">Заключение</a></li>
                            </ol>
                        </div>
                    </div>
                </div>
            </section>
            <section class="aligncenter">
                <div class="wrap">
                    <h2 class="text-landing"><strong>Задача</strong></h2>
                </div>
            </section>
            <section class="wrap">
                <div class="size-75">
                    <div class="wrap bg-white shadow" style="padding: 3rem;">
                        <h4>Лична мотивация</h4>
                        <p>Прилагане на знания от курсовете „Проектиране и обработка на естествен език“ и „Извличане на
                            информация“. Запознаване с Python чрез изграждане на напълно функционираща система.</p>
                        <h4>Техническа задача</h4>
                        <ul>
                            <li>Създаване на търсачка с два подхода:
                                <ul>
                                    <li>Семантично търсене чрез document embeddings</li>
                                    <li>Традиционно индексиране с \(\text{tf}\), \(\text{idf}\) и \(\text{BM25}\)</li>
                                </ul>
                            </li>
                            <li>Допълнителни функционалности:
                                <ul>
                                    <li>Индексиране чрез crawling</li>
                                    <li>Корекция на правописа</li>
                                    <li>Предложения за допълване на заявката за търсене</li>
                                    <li>Удобен графичен интерфейс</li>
                                </ul>
                            </li>
                            <li>Оценяване чрез обективни метрики</li>
                        </ul>
                    </div>
                </div>
            </section>
            <section class="wrap">
                <h3>Задачи за курса по <i>Извличане на информация“</i></h3>
                <hr>
                <div class="size-75">
                    <div class="bg-white shadow">
                        <ul>
                            <li><b>web crawler</b>
                                <ul>
                                    <li>корпус от документи от домейна <code>bg.wikipedia.org</code></li>
                                    <li>\(441 385\) документа, от които \(302 500\) - статии, а останалите -
                                        пренасочващи статии
                                    </li>
                                </ul>
                            </li>
                            <li><b>изграждане на индекс за търсене</b>
                                <ul>
                                    <li>използване на токените от модула за ОЕЕ</li>
                                    <li>изграждане на TF-IDF индекс</li>
                                    <li>изграждане на позиционен индекс от оригиналните думи (to lowercase)</li>
                                    <li>ранкиране при търсене чрез \(\text{BM25}\)</li>
                                </ul>
                            </li>
                            <li><b>допълване на заявките за търсене</b>
                                <ul>
                                    <li><i>query autocompletion</i></li>
                                </ul>
                            </li>
                            <li><b>корекция на правописа</b></li>
                            <li><b>кратки резюмета</b></li>
                            <li><b>обективна оценка на резултатите</b></li>
                        </ul>
                    </div>
                </div>
            </section>
            <section class="aligncenter">
                <div class="wrap">
                    <h2 class="text-landing"><strong>Имплементация</strong></h2>
                </div>
            </section>
            <section class="wrap">
                <h3>Архитектура</h3>
                <hr>
                <div class="size-75 bg-white shadow wrap">
                    <img src="./static/images/architecture.png" alt="">
                </div>
            </section>
            <section class="wrap">
                <h3>Архитектура</h3>
                <hr>
                <div class="size-75 bg-white shadow wrap">
                    <ul>
                        <li><b>REST API</b>
                            <ul>
                                <li>удобен за ползване интерфейс</li>
                                <li>позволява консумиране от друга система</li>
                                <li>позволява платформено независим интерфейс</li>
                            </ul>
                        </li>
                        <li><b>графичен интерфейс</b>
                            <ul>
                                <li>изграден с <code>Flask</code> и чист HTML, CSS, JS</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </section>
            <section class="wrap">
                <h3>Crawling</h3>
                <hr>
                <div class="size-75">
                    <div class="bg-white shadow">
                        <ul>
                            <li>чрез <code>beautifulsoup4</code></li>
                            <li>главна опашка със <b>следващи адреси</b></li>
                            <li>списък с <b>посетени адреси</b></li>
                            <li>респектиране на <b>robots.txt</b> и хоста</li>
                            <li>възможност за добавяне на <b>обработения текст</b> към база данни или опашка от задания
                                за индексиране</li>
                        </ul>
                    </div>
                </div>
            </section>
            <section class="wrap">
                <h3>Изграждане на индекс</h3>
                <hr>
                <div class="size-75">
                    <div class="bg-white shadow">
                        <ul>
                            <li>
                                <b>HDD памет</b> - индекс на файловата система не работи
                            </li>
                            <li><b>MySQL</b> база данни - държи данните на диска, но кешира най-пресните данни</li>
                            <li><b>възможност</b> за лесна скалируемост чрез преминаване към <b>разпределена БД</b></li>
                            <li><b>TF-IDF индекс</b></li>
                            <!-- <p>
                                \begin{align*}
                                \text{tf}_{t, d} &= \frac{f_{t,d}}{\sum_\limits{t \in d} f_{t,d}}\\
                                \text{idf}_t &= \ln \left( \frac{N}{df_t} \right)
                                \end{align*}
                            </p> -->
                            <li><b>позиционен индекс</b></li>
                        </ul>
                    </div>
                </div>
            </section>
            <section class="wrap">
                <h3>Търсене и ранкиране</h3>
                <hr>
                <div class="size-75">
                    <div class="bg-white shadow">
                        <ul>
                            <li>намиране на \(\text{tf}\), \(\text{df}\) и \(\text{idf}\)</li>
                            <li>ранкиране с \(\text{BM25}\)</li>
                            <p>
                                \[
                                \text{BM25}_{d, Q} = \sum_{t \in Q} {\left[\ln \left( \frac{N - \text{df}_t +
                                0.5}{\text{df}_t +
                                0.5}\right)
                                \cdot
                                \frac
                                {\text{tf}_{t,d} \cdot (k_1 + 1)}
                                {\text{tf}_{t,d} + k_1 \cdot \left(1 - b + b
                                \cdot\frac{|d|}{\text{avgdl}}\right)}\right]}
                                \]
                            </p>
                        </ul>
                    </div>
                </div>
            </section>
            <section class="wrap">
                <h3>Допълване на заявките за търсене
                </h3>
                <hr>
                <div class="size-75">
                    <div class="bg-white shadow">
                        <ul>
                            <li><b>обикновено</b> се прави с <i>trie</i> или биграми</li>
                            <li><b>по-добра идея</b> - <i>Directed Acyclic Word Graph (DAWG)</i></li>
                            <li><b>два DAWG графа</b> с данни от позиционния индекс
                                <ul>
                                    <li>за единични думи</li>
                                    <li>за словосъчетания</li>
                                </ul>
                            </li>
                            <li>сложност \(\mathcal{O}\left(n\right)\)</li>
                        </ul>
                    </div>
                </div>
            </section>
            <section class="wrap">
                <div class="size-75">
                    <h3>Корекция на правописа
                    </h3>
                    <hr>
                    <div class="bg-white shadow">
                        <ul>
                            <li>чрез <code>hunspell</code></li>
                            <li>речник по подразбиране</li>
                            <li>скрипт за изграждане на речник от корпуса</li>
                        </ul>
                    </div>
                </div>
            </section>
            <section class="wrap">
                <div class="size-75">
                    <h3>Оценяване</h3>
                    <hr>
                    <div class="bg-white shadow">
                        <ul>
                            <li><b>Клас за генериране на заявки</b>
                                <ul>
                                    <li>произволни заглавия на статии от индекса</li>
                                    <li>популярни словосъчетания от произволни документи</li>
                                </ul>
                            </li>
                            <li><b>Клас за оценяване</b> с параметри:
                                <ul>
                                    <li><b>групи</b>: 5</li>
                                    <li><b>заявки в група</b>: 30</li>
                                    <li><b>резулти в заявка</b>: 20</li>
                                </ul>
                            </li>
                            <li>
                                Намиране на <b>95%-доверителен интервал</b> за Precision, Recall & F1 чрез всички групи
                                заявки
                            </li>
                            <li><b>Златен стандарт</b>
                                <ul>
                                    <li>използването на Уикипедия - невъзможно поради проблеми с векторния индекс</li>
                                    <li>с цел демонстрация и сравнение - 1000 документа в индексите</li>
                                    <li>ElasticSearch - безплатна, доказано ефективна търсачка с отворен код</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>
            <section class="aligncenter">
                <div class="wrap">
                    <h2 class="text-landing"><strong>Резултати</strong></h2>
                </div>
            </section>
            <section class="fullscreen">
                <div class="embed">
                    <iframe src="http://localhost:5000/" width="800" height="600" allowfullscreen></iframe>
                </div>
            </section>
            <!-- <section class="hidden">
                <div class="wrap">
                    <div class="content-left">
                        <h3 class="aligncenter">Precision, Recall & F1 <br> за векторен индекс</h3>
                    </div>
                    <div class="content-left">
                        <p>95%-доверителен интервал за Precision, Recall & F1. Изчислен чрез 5 групи от по 30 заявки, с
                            по 20 резултата в заявка</p>
                    </div>
                    <ul class="flexblock metrics bg-gray">
                        <li> Precision
                            <span>0.130</span>
                            ± 0.021
                        </li>
                        <li> Recall
                            <span>0.419</span>
                            ± 0.055
                        </li>
                        <li> F1
                            <span>0.142</span>
                            ± 0.019
                        </li>
                    </ul>
                </div>
            </section> -->
            <section class="wrap">
                <div class="wrap">
                    <div class="content-left">
                        <h2 class="aligncenter">Precision, Recall & F1 <br> за TF-IDF индекс</h2>
                    </div>
                    <div class="content-left">
                        <p>95%-доверителен интервал за Precision, Recall & F1. Изчислен чрез 5 групи от по 30 заявки, с
                            по 20 резултата в заявка</p>
                    </div>
                    <ul class="flexblock metrics bg-gray">
                        <li> Precision
                            <bruh style="color: green"><span>0.870</span>
                                ± 0.034
                            </bruh>
                        </li>
                        <li> Recall
                            <bruh style="color: green;">
                                <span>0.893 </span>
                                ± 0.029
                            </bruh>
                        </li>
                        <li> F1
                            <bruh style="color:green;">
                                <span>0.877 </span>
                                ± 0.030
                            </bruh>
                        </li>
                    </ul>
                </div>
            </section>
            <!-- <section class="bg-light-gray hidden">
                <h3>Причини за неуспеха на векторния индекс</h3>
                <hr>
                <div class="wrap size-75">
                    <div class="bg-white shadow">
                        <ul class="flexblock reasons">
                            <li>
                                <h3>Неподходящ модел</h3>
                                <p>
                                    Избраният модел бе сред най-добрите, но показателите може да не се отнасят за
                                    българския език.
                                    <br>
                                    Модели за векторизация, насочени към българския език, ще дадат по-добри
                                    резултати.
                                </p>
                            </li>
                            <li>
                                <h3>Неподходящо сравнение</h3>
                                <p>Резултатите от векторния индекс се сравняват с резултати, върнати от TF-IDF индекс.
                                    <br>Векторният индекс връща колкото резултати желаем. TF-IDF индексът връща само
                                    "релевантни" резултати.
                                    <br>Връщане на <s>20</s> 5 релевантни резултата подобрява резултата на векторния
                                    индекс с над 100%.
                                </p>
                            </li>
                        </ul>
                    </div>
                </div>
            </section> -->
            <!-- <section class="hidden">
                <div class="wrap">
                    <h3>Два вида индекси</h3>
                    <div class="grid">
                        <div class="column">
                            <pre>



{
    "batch": 1,
    "query": "Диоген",
    "engine_results": [
        "43666"
    ],
    "gold_results": [
        "43666"
    ],
}



                    </pre>
                            <p class="aligncenter">Резултати от обратен индекс</p>
                        </div>
                        <div class="column">
                            <pre>
{
    "batch": 1,
    "query": "Диоген",
    "engine_results": [
        "43666",
        "559",
        "44945",
        "50806",
        "67871",
        ...
        "426900"
    ],
    "gold_results": [
        "43666"
    ]
}
                    </pre>
                            <p class="aligncenter">Резултати от векторен индекс</p>
                        </div>
                    </div>
                </div>
                <!-- .end .wrap -->
            </section> -->
            <section class="wrap">
                <div class="wrap aligncenter">
                    <h2 class="text-landing"><strong>Заключение</strong></h2>
                </div>
            </section>
            <section class="wrap">
                <div class="size-75">
                    <h3>Заключение. Възможни подобрения
                    </h3>
                    <hr>
                    <div class="bg-white shadow">
                        <ul>
                            <li>добро представяне на \(\text{TF-IDF} + \text{BM25}\) индекса</li>
                            <li>успешна <b>корекция на правописа</b> и <b>допълване на заявките</b></li>
                            <li><b>бъдещо подобрение</b>
                                <ul>
                                    <li>индексиране на целия домейн на <code>bg.wikipedia.org</code></li>
                                    <li>оценяване от хора оценители</li>
                                    <li>интелигентно комбиниране на резултатите от TF-IDF и векторния индекс</li>
                                    <li>експерименти за корекция на правописа с думи от корпуса</li>
                                    <li>предложения за допълване на заявките въз основа на потребителски логове</li>
                                    <li>динамични резюмета (<i>KWIC Snippets</i>)</li>
                                    <li>търсене чрез потребителски метаданни - история, локация, език и др.</li>
                                    <li>надграждане на идеята за многоезични корпуси - откриване на езика и прилагане на
                                        специфичен лематизатор за него; <br>разпределена БД за всеки език</li>
                                    <li>по-висока производителност</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>
        </article>
    </main>
    <!--main-->

    <!-- Required -->
    <script src="./static/js/webslides.js"></script>

    <script>
        window.ws = new WebSlides();
    </script>

    <!-- OPTIONAL - svg-icons.js (fontastic.me - Font Awesome as svg icons) -->
    <script defer src="./static/js/svg-icons.js"></script>

</body>

</html>